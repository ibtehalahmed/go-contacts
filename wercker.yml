  # This references the default golang container from
  # the Docker Hub: https://registry.hub.docker.com/u/library/golang/
  # If you want Google's container you would reference google/golang
  # Read more about containers on our dev center
  # http://devcenter.wercker.com/docs/containers/index.html
  box: golang:1.6 #the latest is golang
  # This is the build pipeline. Pipelines are the core of wercker
  # Read more about pipelines on our dev center
  # http://devcenter.wercker.com/docs/pipelines/index.html

  # You can also use services such as databases. Read more on our dev center:
  # http://devcenter.wercker.com/docs/services/index.html
  # services:
      # - postgres
      # http://devcenter.wercker.com/docs/services/postgresql.html

      # - mongo
      # http://devcenter.wercker.com/docs/services/mongodb.html
  services:
    - id: mongo
  build:
    # The steps that will be executed on build
    # Steps make up the actions in your pipeline
    # Read more about steps on our dev center:
    # http://devcenter.wercker.com/docs/steps/index.html
    steps:
      # Sets the go workspace and places you package
      # at the right place in the workspace tree
      - setup-go-workspace

      # Gets the dependencies
      - script:
          name: go get
          code: |
            go get -u github.com/tools/godep

      # Build the project
      - script:
          name: go build
          code: |
            go build
            ls
            cp -rp . "$WERCKER_OUTPUT_DIR"
      # Before test
      - script:
          name: before test
          code: |
            export GIN_MODE=release
      # Test the project
      - script:
          name: go test
          code: |
            go test $(go list ./... | grep -v /vendor/) -v
    after-steps:
      - slack-notifier:
        url: https://hooks.slack.com/services/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
        channel: contact
        username: wercker

    after-steps:
      - slack-notifier:
        url: https://hooks.slack.com/services/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
        channel: contact
        username: wercker
